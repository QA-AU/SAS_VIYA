proc python;
submit;
import pandas as pd
import json
import re
import traceback

json_str = '''PUT_YOUR_JSON_HERE'''

try:
    data = json.loads(json_str)
    records = [data] if isinstance(data, dict) else data

    df = pd.json_normalize(records, max_level=1)

    def clean_sas_column(col):
        return re.sub(r"[^A-Za-z0-9_]", "_", col)[:32]
    df.columns = [clean_sas_column(col) for col in df.columns]

    print(df.head())
    SAS.df2sd(df, 'work.json_temp', replace=True)
    print("SUCCESS: Loaded to work.json_temp")
except Exception as e:
    print(traceback.format_exc())
endsubmit;
run;
